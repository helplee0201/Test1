import streamlit as st
import pandas as pd

def get_checklist_data():
    # "지표" 시트 데이터를 기반으로 체크리스트 생성
    checklist_data = [
        {"영역": "데이터 관리 체계", "지표": "품질관리 계획 수립", "내용": "테크핀레이팅스는 데이터 품질관리를 위한 계획과 이행결과(성과)를 포함하여 데이터의 제공 및 이용 활성화에 대한 시행계획을 수립함"},
        {"영역": "데이터 관리 체계", "지표": "데이터 구조 안정화", "내용": "테크핀은 향후 더존이 보유한 300만 이상 사업자에 대한 데이터 처리 및 가공에 대비하여 서버 증설 및 관리 체계를 수립함"},
        {"영역": "데이터 관리 체계", "지표": "데이터 구조 안정화", "내용": "▶ 25년 7월부터 대용량 데이터 저장 및 속도 향상을 위해 Vertica를 도입하여 DB 전환을 진행 중임"},
        {"영역": "데이터 관리 체계", "지표": "데이터 전담 조직 생성", "내용": "부가세 상품 제공을 위해 DB개발팀, 신용평가팀, 정보사업팀 3개 부서가 협업하고 있으며 팀 내 금융기관과 소통하는 업무담당자를 1인 이상 배정함"},
        {"영역": "데이터 값 관리", "지표": "커버리지 확대", "내용": "테크핀은 회계프로그램을 통한 전자신고 사업자 수 (약 397만) 중에서 약 325만 사업자 정보를 보유하고 있음(전체 커버리지 82%)"},
        {"영역": "데이터 값 관리", "지표": "커버리지 확대", "내용": "전체 325만 사업자 중에서 특정 사업자를 대상으로 부가세 상품(7개 테이블)을 생성함"},
        {"영역": "데이터 값 관리", "지표": "커버리지 확대", "내용": "특정 사업자는 법적으로 기장 의무가 존재하는 법인과 복식부기대상자인 사업소득자로 금융기관을 통한 제 3자 정보제공동의가 완료된 대상에 한함"},
        {"영역": "데이터 값 관리", "지표": "커버리지 확대", "내용": "또한 기장정보가 존재하더라도 테크핀 클렌징로직을 적용하여 데이터 연속성 조건 등을 필터링하고 있음"},
        {"영역": "데이터 값 관리", "지표": "커버리지 확대", "내용": "따라서 더존이 보유하고 있는 커버리지 (80%) 대비 테크핀에서 정보를 제공하고 있는 커버리지는 50% 내외로 집계됨"},
        {"영역": "데이터 값 관리", "지표": "커버리지 확대", "내용": "매월 금융기관에서 전달하는 차주 대비 테크핀에서 산출하여 전송하는 사업자번호를 집계하여 커버리지 증감을 체크함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 최신성 유지", "내용": "더존은 매달 중순부터 15일동안 WEHAGO F1DB(실시간 기장 데이터)에서 데이터를 수집하여 하둡에 적재함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 최신성 유지", "내용": "하둡에 적재된 데이터는 45개 테이블로 가공되어 매달 초 테크핀으로 전송되며 테크핀 DB담당자는 약 15일 동안 테크핀 내 DB에 적재함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 최신성 유지", "내용": "대용량 DB에 대한 배치 작업으로 인해 기준년월 대비 최대 2개월 전 기장 데이터를 제공할 수 있음 (일부 1개월 전 데이터 포함)"},
        {"영역": "데이터 값 관리", "지표": "데이터의 최신성 유지", "내용": "단기적으로 수집-적재-가공 프로세스 과정을 단축하여 전월 기장 데이터를 제공할 수 있도록 업그레이드 해야함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 최신성 유지", "내용": "중장기적으로 데이터 수집 원천을 F1DB로 변경하여 실시간 데이터를 제공하는 구조로 바꿔야 함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 무결성 보장", "내용": "테크핀은 사업자번호 단위로 회계기수별로 테이블을 수집함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 무결성 보장", "내용": "사업자는 회계기간 중에는 전표 입력, 수정, 삭제 등을 진행하고 회계기수가 끝나면 전표를 수정하지 않음"},
        {"영역": "데이터 값 관리", "지표": "데이터의 무결성 보장", "내용": "테크핀은 일반적인 전표 수정 범위를 고려하여 최대 8분기 (기준월로부터 과거 24개월)까지 변동을 체크함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 무결성 보장", "내용": "사업자별 24개월 범위 내 과거 전송 분 대비 변경된 행이 존재하는 경우 당월 기준으로 업데이트 함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 무결성 보장", "내용": "예시 : 회계기간이 2024년 1월~12월인 법인 사업자의 경우 2025년 4월 30일 지방세 신고 종료월까지 전년도 데이터를 수정함"},
        {"영역": "데이터 값 관리", "지표": "데이터의 무결성 보장", "내용": "개인 사업자의 경우 2025년 6월 30일까지 전년도 데이터를 수정함 (성실신고대상자 포함)"},
        {"영역": "데이터 값 관리", "지표": "차별화된 정보 제공", "내용": "더존 ERP를 사용하는 세무대리인은 1개의 사업자번호에 대해서 복수개의 회사코드를 생성하여 기장을 함 (부가세, 원천세, 법인세 등 용도별 구분)"},
        {"영역": "데이터 값 관리", "지표": "차별화된 정보 제공", "내용": "테크핀은 더존으로부터 동일한 사업자번호로 기재된 복수개 회사코드 DB를 전달받은 후 테크핀 클렌징 로직을 적용하여 1개의 회사코드만 선택함"},
        {"영역": "데이터 값 관리", "지표": "차별화된 정보 제공", "내용": "테크핀이 제공하는 통합데이터는 법인격 또는 대표자 기준의 합산 정보로서 사업장정보 실제 사업자의 경영 상태를 확인하는 지표임"},
        {"영역": "데이터 값 관리", "지표": "차별화된 정보 제공", "내용": "▶ 통합데이터 : 법인세 신고용도로 본점, 복수개의 지점 기장 내역을 합친 데이터"},
        {"영역": "데이터 값 관리", "지표": "차별화된 정보 제공", "내용": "▶ 본점데이터 : 부가세 신고용도로 본점 내역만을 포함한 데이터"}
    ]
    
    # DataFrame 생성
    df_checklist = pd.DataFrame(checklist_data)
    
    # Streamlit에서 체크리스트 표시
    st.write("데이터 품질 관리 체크리스트")
    st.write("각 항목을 검토한 후 O/X를 체크하세요:")
    
    # 체크리스트 테이블 생성
    checklist_results = []
    for index, row in df_checklist.iterrows():
        # O/X 체크박스 추가
        check = st.checkbox(f"{row['영역']} - {row['지표']} - {row['내용']}", key=f"check_{index}")
        checklist_results.append({
            "영역": row["영역"],
            "지표": row["지표"],
            "내용": row["내용"],
            "체크": "O" if check else "X"
        })
    
    # 결과 DataFrame 생성
    df_results = pd.DataFrame(checklist_results)
    
    # 스타일링 적용
    styled_df = df_results.style.set_properties(**{
        'text-align': 'left',
        'border': '2px solid #333',
        'padding': '8px'
    }).set_table_styles([
        {'selector': 'th', 'props': [('background-color', '#e6f3ff'), ('border', '2px solid #333'), ('text-align', 'left')]}
    ])
    
    st.dataframe(styled_df, use_container_width=True)

    return df_results
